<launch>
    <arg name="joy_device" default="/dev/input/js0"/>
    <arg name="repeat_rate" default="0.0"/>
    <arg name="joy_config" default="$(find mercury_trajectory)/config/joy.yaml"/>
    <arg name="trajectory_config" default="$(find mercury_trajectory)/config/trajectory.yaml"/>
    <arg name="display_gui" default="true"/>
    <arg name="xsense_device" default="/dev/ttyUSB0"/>

    <node pkg="joy" type="joy_node" name="ros_joy">
        <param name="dev" value="$(arg joy_device)"/>
        <param name="autorepeat_rate" value="$(arg repeat_rate)"/>
    </node>

    <node pkg="mercury_joy" type="joy-node.py" name="mercury_joy"/>
    <node pkg="mercury_trajectory" type="trajectory-node.py" name="mercury_trajectory"/>
    <node name="dynamic_reconfigure_load_trajectory" pkg="dynamic_reconfigure" type="dynparam" args="load /mercury_trajectory $(arg trajectory_config)" />
    <node name="dynamic_reconfigure_load_joy" pkg="dynamic_reconfigure" type="dynparam" args="load /mercury_joy $(arg joy_config)" />
    
    <include file="$(find xsens_driver)/launch/xsens_driver.launch">
        <arg name="device" value="$(arg xsense_device)"/>
    </include>

    <node pkg="mercury_feedback" type="feedback_node.py" name="mercury_feedback">
        <param name="reciver_main_board_port" type="int" value="3031"/>
        <param name="reciver_sensor_board_port" type="int" value="3040"/>
        <param name="queue_size" type="int" value="10"/>
        <remap from="/feedback/co2" to="/mercury/gui/co2"/>
    </node>

    <include if="$(arg display_gui)" file="$(find rosbridge_server)/launch/rosbridge_websocket.launch"/>
    <node if="$(arg display_gui)" pkg="mercury_gui" type="electron" name="mercury_gui" args="index.js" cwd="node"/>
    <node if="$(arg display_gui)" pkg="mercury_gui" type="imu.py" name="mercury_gui_imu"/>
</launch>